// ============================================
// Table of Contents Navigation
// ============================================
// TOC navigation component with nested lists
// Last Updated: 2026-01-21

// --------------------------------------------
// TOC Container
// --------------------------------------------
nav.toc {
  // TOC container base styles
  position: relative;
  background: white;
  border-radius: $border-radius-large;
  box-shadow: $shadow-medium;
  margin: $spacing-lg 0;

  // TOC title (h2)
  h2 {
    background: linear-gradient(135deg, $primary-color, #003a6b);
    color: white;
    padding: $spacing-md $spacing-lg;
    cursor: pointer;
    user-select: none;
    margin: 0;
    font-size: 1.3rem;
    font-weight: 600;
    text-align: center;
    border-radius: $border-radius $border-radius 0 0;

    &:focus {
      outline: 2px solid $primary-color;
      outline-offset: 2px;
    }
  }

  // TOC list container
  > ul {
    max-height: none;
    overflow: visible;
    transition: max-height 0.3s ease;
    background: white;
    margin: 0;
    padding: $spacing-sm 0;
    list-style: none;
  }

  // List items
  li {
    margin: 0 !important;
    padding: 0 !important;
    position: relative;

    // Parent level links (Level 0)
    > a {
      display: block;
      padding: $spacing-sm $spacing-md;
      color: #1a365d !important;
      text-decoration: none !important;
      border-radius: $border-radius;
      transition: all 0.3s ease;
      font-weight: 700;
      border-left: 4px solid transparent;
      background: transparent;

      &:hover,
      &:focus {
        background: rgba(26, 54, 93, 0.12) !important;
        color: #003a6b !important;
        border-left-color: #1a365d;
        transform: translateX(6px);
        box-shadow: 0 3px 12px rgba(26, 54, 93, 0.25);
      }

      &:target,
      &.active {
        background: #1a365d !important;
        color: white !important;
        border-left-color: #003a6b;
        font-weight: 700;
      }
    }

    // Nested lists (Level 1)
    ul {
      max-height: 0;
      opacity: 0;
      visibility: hidden;
      overflow: hidden;
      transform: translateY(-10px);
      transition: max-height 0.3s ease, opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
      margin: 0;
      padding: 0;

      // Child level list items
      li {
        // Child level links (Level 1)
        a {
          display: block;
          padding: $spacing-xs $spacing-md;
          color: #2d5a87 !important;
          text-decoration: none !important;
          border-radius: $border-radius;
          transition: all 0.3s ease;
          font-weight: 500;
          border-left: 3px solid transparent;
          background: transparent;

          &:hover,
          &:focus {
            background: rgba(45, 90, 135, 0.1) !important;
            color: #1a365d !important;
            border-left-color: #2d5a87;
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(45, 90, 135, 0.2);
          }

          &:target,
          &.active {
            background: #2d5a87 !important;
            color: white !important;
            border-left-color: #1a365d;
            font-weight: 500;
          }
        }

        // Grandchild level (Level 2)
        ul {
          li {
            a {
              display: block;
              color: #4a7ba7 !important;
              font-weight: 400;
              font-size: 0.9rem;
              padding: $spacing-xs $spacing-sm;
              margin-left: calc($spacing-xl + $spacing-lg);
              padding-left: $spacing-xl;
              border-left: 2px solid transparent;
              line-height: 1.2;
              text-decoration: none !important;

              &:hover,
              &:focus {
                background: rgba(74, 123, 167, 0.08) !important;
                color: #2d5a87 !important;
                border-left-color: #4a7ba7;
                transform: translateX(3px);
                box-shadow: 0 2px 6px rgba(74, 123, 167, 0.15);
              }

              &:target,
              &.active {
                background: #4a7ba7 !important;
                color: white !important;
                border-left-color: #2d5a87;
                font-weight: 400;
              }
            }
          }
        }
      }
    }
  }

  // Sticky TOC modifier
  &.toc-sticky {
    position: fixed;
    top: 70px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    max-width: min(800px, 90vw);
    width: 100%;

    h2 {
      padding: $spacing-sm $spacing-lg;
      font-size: 1.1rem;
    }

    > ul {
      max-height: 0;
      overflow: hidden;
      padding: 0;
    }

    &:hover,
    &:focus-within {
      > ul {
        max-height: 70vh;
        overflow-y: auto;
        padding: $spacing-sm 0;
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
    }

    // Nested media queries for responsive behavior
    @include tablet {
      max-height: 50px;
      top: 50px;

      &:hover > ul {
        max-height: 50vh !important;
      }
    }

    @include desktop {
      max-height: 70px;
      top: 70px;

      h2 {
        font-size: 1.3rem !important;
        padding: $spacing-lg $spacing-xl !important;
      }

      &:hover {
        max-height: 80vh;

        ul {
          max-height: calc(80vh - 90px);
        }
      }
    }
  }
}

// --------------------------------------------
// WordPress Admin Bar Compatibility
// --------------------------------------------
// Task: mytechtoday-3ca9.4 - Add WordPress admin bar compatibility
// Adjust sticky TOC positioning when WordPress admin bar is present

// Desktop admin bar (32px height)
body.admin-bar nav.toc.toc-sticky {
  top: 102px !important; // 70px + 32px admin bar

  @include desktop {
    top: 102px !important; // 70px + 32px admin bar
  }
}

// Mobile admin bar (46px height on screens <= 782px)
@media (max-width: 782px) {
  body.admin-bar nav.toc.toc-sticky {
    top: 96px !important; // 50px + 46px mobile admin bar
  }
}

// --------------------------------------------
// TOC Navigation Container (outside nav.toc)
// --------------------------------------------
nav.toc {
  // Z-index hierarchy
  z-index: 1000;

  &.toc-sticky {
    z-index: 9999;
  }

  // Responsive adjustments
  @include tablet {
    margin-left: $spacing-md;
    margin-right: $spacing-md;
    max-width: calc(100% - 2 * $spacing-md);
  }
}

// --------------------------------------------
// End of TOC Navigation
// --------------------------------------------

